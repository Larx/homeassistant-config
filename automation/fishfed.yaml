# MQTT Trigger for Feeding Fish
#
- id: fish_fed_light_off
  alias: 'Fed Fish'
  trigger:
    - platform: mqtt
      topic: fishmon/tank1/feeding
      payload: 'FED'

  condition:
    condition: state
    entity_id: sun.sun
    state: 'below_horizon'

  action:
    - service: tts.google_say
      data:
        entity_id: media_player.kitchen_speaker
        message: Fish Light will be turned off in thirty minutes.
    - service: notify.facebook_notifications
      data:
        message: "Fish Light will be turned off in 30 minutes"
        target: !include ../secret/alarm_facebook_alerts.yaml
    - delay: '00:30:00'
    - service: switch.turn_off
      entity_id: switch.fish_lamp
    - service: notify.facebook_notifications
      data:
        message: "Fish Light has been turned off"
        target: !include ../secret/alarm_facebook_alerts.yaml
      
